[{"/Users/jonathanyap/Downloads/sight/src/index.js":"1","/Users/jonathanyap/Downloads/sight/src/reportWebVitals.js":"2","/Users/jonathanyap/Downloads/sight/src/App.js":"3"},{"size":535,"mtime":1699312634000,"results":"4","hashOfConfig":"5"},{"size":362,"mtime":1699312634000,"results":"6","hashOfConfig":"5"},{"size":5708,"mtime":1699935436180,"results":"7","hashOfConfig":"5"},{"filePath":"8","messages":"9","suppressedMessages":"10","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"1x565ah",{"filePath":"11","messages":"12","suppressedMessages":"13","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"14","messages":"15","suppressedMessages":"16","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"17"},"/Users/jonathanyap/Downloads/sight/src/index.js",[],[],"/Users/jonathanyap/Downloads/sight/src/reportWebVitals.js",[],[],"/Users/jonathanyap/Downloads/sight/src/App.js",["18","19"],[],"import React, { useState, useCallback, useEffect } from 'react';\nimport './App.css';\nimport Webcam from 'webcam-easy';\nfunction App() {\n  const [file, setFile] = useState(null);\n  const [preview, setPreview] = useState('');\n  const [result, setResult] = useState('');\n  const [statusMessage, setStatusMessage] = useState('');\n  const [uploadProgress, setUploadProgress] = useState(0);\n  const [dragOver, setDragOver] = useState(false);\n  //const [isCameraOpen, setIsCameraOpen] = useState(false);\n  const webcamElement = document.getElementById('webcam');\nconst canvasElement = document.getElementById('canvas');\nconst snapSoundElement = document.getElementById('snapSound');\nconst webcam = new Webcam(webcamElement, 'user', canvasElement, snapSoundElement);\nlet isCamOpen = true;\n  const handleFileChange = useCallback((selectedFile) => {\n    setFile(selectedFile);\n    setPreview(URL.createObjectURL(selectedFile));\n    setStatusMessage('Image selected. Click \"Analyze Image\" to proceed.');\n    setUploadProgress(0);\n  }, []);\n  // useEffect(()=>{\n  //     webcam.start().then(()=>{\n  //     });\n  //   return () => {\n  //     webcam.stop();\n  //   };\n  // },[]);\n  // const handleBeforeUnload = () =>{\n  //   console.log(\"stop camera\");\n  //   webcam.stop();\n  // }\n  const handleSnap = () => {\n      const picture = webcam.snap();\n      console.log(picture);\n      document.querySelector('#download-photo').href = picture;\n      webcam.stop();\n  }\n  const openCamera = () =>{\n    webcam.start();\n  }\n  const handleSubmit = async (event) => {\n    event.preventDefault();\n    if (!file) {\n      setStatusMessage('No file selected!');\n      return;\n    }\n    setStatusMessage('Sending request...');\n    setUploadProgress(10); // Initial progress\n    const reader = new FileReader();\n    reader.readAsDataURL(file);\n    reader.onload = async () => {\n      const base64String = reader.result\n        .replace('data:', '')\n        .replace(/^.+,/, '');\n      const data = {\n        model: \"gpt-4-vision-preview\",\n        messages: [\n          {\n            \"role\": \"user\",\n            \"content\": [\n              {\n                \"type\": \"text\",\n                \"text\": \"Imagine that I am a visual impaired individual. Could you explain what you see in this image as if I am seeing the picture?\"\n              },\n              {\n                \"type\": \"image_url\",\n                \"image_url\": {\n                  \"url\": `data:image/jpeg;base64,${base64String}`\n                }\n              }\n            ]\n          }\n        ],\n        max_tokens: 300\n      };\n      try {\n        const response = await fetch('https://api.openai.com/v1/chat/completions', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n            'Authorization': `Bearer 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` // Use environment variable for API key\n          },\n          body: JSON.stringify(data)\n        });\n        setUploadProgress(50); // Midway progress\n        if (!response.ok) {\n          throw new Error(`HTTP error! status: ${response.status}`);\n        }\n        const apiResponse = await response.json();\n        setUploadProgress(100); // Final progress\n        if (apiResponse.choices && apiResponse.choices.length > 0) {\n          setResult(apiResponse.choices[0].message.content);\n          setStatusMessage('Analysis complete.');\n        } else {\n          console.error('No choices returned from API');\n          setStatusMessage('Failed to get a response from the API.');\n        }\n      } catch (error) {\n        console.error('Error:', error);\n        setStatusMessage('An error occurred during the analysis.');\n      }\n    };\n    reader.onerror = (error) => {\n      console.error('Error:', error);\n      setStatusMessage('File reading failed!');\n    };\n  };\n  const handleDragOver = useCallback((event) => {\n    event.preventDefault();\n    setDragOver(true);\n  }, []);\n  const handleDragLeave = useCallback(() => {\n    setDragOver(false);\n  }, []);\n  const handleDrop = useCallback((event) => {\n    event.preventDefault();\n    setDragOver(false);\n    const files = event.dataTransfer.files;\n    if (files.length) {\n      handleFileChange(files[0]);\n    }\n  }, [handleFileChange]);\n  return (\n    <div className=\"App\">\n      <h1>Sight</h1>\n      <div\n        className={`drop-area ${dragOver ? 'drag-over' : ''}`}\n        onDrop={handleDrop}\n        onDragOver={handleDragOver}\n        onDragLeave={handleDragLeave}\n        onClick={() => document.getElementById('fileUpload').click()}\n      >\n        <input\n          id=\"fileUpload\"\n          type=\"file\"\n          onChange={(e) => handleFileChange(e.target.files[0])}\n          accept=\"image/*\"\n          style={{ display: 'none' }}\n        />\n        {preview ? (\n          <img src={preview} alt=\"Preview\" className=\"image-preview\" />\n        ) : (\n          <p>Drag and drop an image here, or click to select an image to upload.</p>\n        )}\n      </div>\n      {statusMessage && <p className=\"status-message\">{statusMessage}</p>}\n      {uploadProgress > 0 && (\n        <progress value={uploadProgress} max=\"100\"></progress>\n      )}\n      <button onClick={handleSnap} className='webcam-button'>Snap</button>\n      <button onClick={openCamera} className='webcam-button'>Open Camera</button>\n      {/* <button onClick={handleGetPhoto} className='webcam-button'>Get Photo</button> */}\n      <button onClick={handleSubmit} className=\"analyze-button\">\n        Analyze Image\n      </button>\n      {result && (\n        <div className=\"result\">\n          <strong>Analysis Result:</strong>\n          <textarea value={result} readOnly />\n        </div>\n      )}\n    </div>\n  );\n}\nexport default App;",{"ruleId":"20","severity":1,"message":"21","line":1,"column":40,"nodeType":"22","messageId":"23","endLine":1,"endColumn":49},{"ruleId":"20","severity":1,"message":"24","line":16,"column":5,"nodeType":"22","messageId":"23","endLine":16,"endColumn":14},"no-unused-vars","'useEffect' is defined but never used.","Identifier","unusedVar","'isCamOpen' is assigned a value but never used."]